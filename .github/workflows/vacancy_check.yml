name: UR Vacancy Checker

on:
  schedule:
    # 1æ™‚é–“ã”ã¨ï¼ˆæ¯æ™‚00åˆ†ï¼‰ã«å®Ÿè¡Œ
    - cron: '0 * * * *' # <-- ã“ã®è¨­å®šã¯ã€Œæ¯æ™‚0åˆ†ã€ã§æ­£ã—ã„ã§ã™
  workflow_dispatch:
    # æ‰‹å‹•å®Ÿè¡Œã‚’å¯èƒ½ã«ã™ã‚‹

jobs:
  check:
    runs-on: ubuntu-latest
    env: # <-- ã€é‡è¦ã€‘ã“ã®è¡Œã‚’è¿½åŠ 
      TZ: Asia/Tokyo # <-- ã€é‡è¦ã€‘ã“ã®è¡Œã‚’è¿½åŠ  (æ—¥æœ¬æ™‚é–“ JST ã«è¨­å®š)
    steps:
      - name: ğŸ“¦ ãƒªãƒã‚¸ãƒˆãƒªã®ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
        uses: actions/checkout@v4

      - name: ğŸ Pythonã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'

      - name: ğŸŒ Chromiumã¨WebDriverã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« # <-- ã€æ–°è¦ã‚¹ãƒ†ãƒƒãƒ—ã€‘
        run: |
          # Chromium (ãƒ–ãƒ©ã‚¦ã‚¶æœ¬ä½“) ã¨å¿…è¦ãªä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
          sudo apt-get update
          sudo apt-get install -y chromium-browser
          # WebDriver (SeleniumãŒãƒ–ãƒ©ã‚¦ã‚¶ã‚’æ“ä½œã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«) ã¯
          # æœ€æ–°ã®Ubuntuç’°å¢ƒã§ã¯Chromiumã¨å…±ã«è‡ªå‹•ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã‚‹ã‹ã€
          # Seleniumå´ã§è‡ªå‹•çš„ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã‚‹ãŸã‚ã€ã“ã“ã§ã¯çœç•¥ã—ã¾ã™ã€‚
          # ä»¥å‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨ã®äº’æ›æ€§ã®å•é¡ŒãŒèµ·ãã‚‹å ´åˆã¯ã€ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’ä¿®æ­£ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

      - name: ğŸ“¦ ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
        run: |
          pip install -r requirements.txt

      - name: ğŸ› ï¸ ç©ºãæƒ…å ±ãƒã‚§ãƒƒã‚¯ã¨é€šçŸ¥ã®å®Ÿè¡Œ
        env:
          # SMTPæƒ…å ±ã‚’ç’°å¢ƒå¤‰æ•°ã¨ã—ã¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«æ¸¡ã™
          SMTP_SERVER: ${{ secrets.SMTP_SERVER }}
          SMTP_PORT: ${{ secrets.SMTP_PORT }}
          SMTP_USERNAME: ${{ secrets.SMTP_USERNAME }}
          SMTP_PASSWORD: ${{ secrets.SMTP_PASSWORD }}
          FROM_EMAIL: ${{ secrets.FROM_EMAIL }}
        run: |
          python check_vacancy.py
